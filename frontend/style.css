/* COPIA TUTTO QUESTO CODICE E SOSTITUISCI IL CONTENUTO DI style.css */
:root {
    --app-bg: #F5F5F5;
    --accent-static: #e11d48; /* rosso saturo per UI statica (header/footer) */
    --card-1: #334155; /* slate-700 */
    --card-2: #3f3a34; /* warm dark */
    --card-3: #3a4a42; /* greenish dark */
    --fg: #F9FAFB;
  }

  body {
    background: var(--app-bg);
    font-family: "Roboto", system-ui, -apple-system, Segoe UI, Helvetica, Arial, sans-serif;
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizeLegibility;
    /* overflow-x: hidden; */
  }

  /* html {
    overflow-x: hidden;
  } */

  .reading-title {
    font-family: inherit !important;
    letter-spacing: -0.01em;
    line-height: 1.3;
    word-break: break-word;
  }

  .reading-copy {
    font-family: inherit !important;
    line-height: 1.75;
    overflow-wrap: anywhere;
    hyphens: auto;
  }

  .reading-copy .md-p { margin: 0 0 .75rem; }
  .reading-copy strong { font-weight: 800; color: #fff; }
  .reading-copy em { font-style: italic; }
  .reading-copy a { color: inherit; text-decoration: underline; text-underline-offset: 2px; }
  .reading-copy code {
    padding: 0 .25rem;
    border-radius: 4px;
    background: rgba(255, 255, 255, .12);
    font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
  }
  .reading-copy .md-list { list-style: disc; padding-left: 1.25rem; margin: .5rem 0 .75rem; }
  .reading-copy .md-list > li { margin: .2rem 0; }

  /* --- COMPONENTI CONSOLIDATI (da piÃ¹ blocchi) --- */
  .tag-chip {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    border-radius: 9999px;
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
    font-weight: 500;
    background-color: rgba(255, 255, 255, 0.1);
    color: #fff;
    border: 1px solid rgba(255, 255, 255, .22);
    transition: background-color 0.15s ease-in-out;
    cursor: pointer;
    backdrop-filter: blur(2px);
  }
  .tag-chip:hover {
    background-color: rgba(255, 255, 255, 0.2);
  }
  .tag-chip[data-empty="true"] {
    opacity: .7;
    border-style: dashed;
  }

  .icon-btn {
    height: 2.25rem;
    width: 2.25rem;
    border-radius: 9999px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    background-color: transparent;
    border: 0;
    transition: background-color 0.15s ease-in-out, transform .12s ease;
    cursor: pointer;
  }
  .icon-btn:hover {
    background-color: rgba(255, 255, 255, 0.1);
    transform: translateY(-1px);
  }
  .icon-btn:active {
    transform: translateY(0);
  }
  .icon-btn .material-symbols-outlined {
    font-size: 22px;
    color: rgba(255, 255, 255, 0.8);
    transition: color .12s ease, font-variation-settings .12s ease;
  }

  /* --- FEED CARD E IMMAGINI --- */
  #feed-container {
    margin-top: 0.1rem;
  }
  .image-wrapper {
    aspect-ratio: 16 / 9;
    line-height: 0; /* Previene gap sotto l'immagine */
    position: relative; /* Necessario per overlay e spinner */
  }
  .card-image {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0;
    transition: opacity 0.3s ease-in-out;
  }
  .card-image.is-loaded {
    opacity: 1;
  }

  /* --- STILI CARD INTERNA (TILE) --- */
  .tile-dark {
    color: var(--fg);
    border-radius: 14px;
    margin-top: 0;
    border-top-left-radius: 0;
    border-top-right-radius: 0;
  }
  .tile-attach { margin-top: -1px; }
  .tile-dark .topline { display: flex; align-items: center; gap: .5rem; margin-bottom: .75rem; }
  .tile-dark .source-logo { font-size: 18px; line-height: 1; opacity: .9; }
  .tile-dark .badge {
    display: inline-flex; align-items: center; gap: .35rem;
    padding: .25rem .5rem; border-radius: 999px; font-size: .75rem;
    background: rgba(255, 255, 255, .12); border: 1px solid rgba(255, 255, 255, .22);
    color: #fff; letter-spacing: .02em;
    backdrop-filter: saturate(120%) blur(2px);
  }
  .tile-dark h2 { font-weight: 700; font-size: 1.375rem; line-height: 1.2; margin: 0 0 .25rem; color: #fff; }
  .tile-dark .reading-copy { color: rgba(255, 255, 255, .92); font-size: .95rem; }
  .tile-dark .muted { opacity: .75; text-transform: capitalize; }

  .tile-actions {
    margin-top: 12px;
    padding: 10px 0 0;
    border-top: 1px solid rgba(255, 255, 255, .18);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
  }
  .tile-actions .action-left { display: flex; align-items: center; gap: 14px; }
  .tile-read {
    font: 600 14px/1.2 system-ui;
    color: #fff;
    opacity: .95;
    padding: 0;
    background: transparent;
    border: none;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: .25rem;
  }
  .tile-read .material-symbols-outlined { font-size: 20px; }

  /* --- ICONE --- */
  .material-symbols-outlined {
    font-family: 'Material Symbols Outlined' !important;
    font-weight: normal; font-style: normal;
    font-size: 24px; line-height: 1;
    letter-spacing: normal; text-transform: none;
    display: inline-block; white-space: nowrap; direction: ltr;
    -webkit-font-feature-settings: 'liga';
    font-feature-settings: 'liga';
    -webkit-font-smoothing: antialiased;
    font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
    transition: font-variation-settings .15s ease-in-out, color .15s ease-in-out;
  }
  .avatar-dot {
    width: 16px; height: 16px;
    border-radius: 9999px;
    background-color: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    object-fit: cover;
    flex-shrink: 0;
  }

  /* --- MODAL E OVERLAY --- */
  .body-lock { overflow: hidden; touch-action: none; }
  .close-button { position: absolute; right: 12px; top: 10px; cursor: pointer; }

  #email-modal {
    position: fixed; inset: 0; z-index: 1000;
    background: rgba(0, 0, 0, 0.5);
  }
  #email-modal .modal-content {
    position: absolute; left: 50%; top: 50%;
    transform: translate(-50%, -50%);
    width: min(92vw, 1000px);
    height: min(88vh, 900px);
    background: #fff; border-radius: 16px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, .2);
    overflow: hidden;
    display: flex; flex-direction: column;
  }
  #email-modal .modal-body { flex: 1; overflow: auto; padding: 0; }
  #email-modal iframe { display: block; width: 100%; height: 100%; border: 0; background: #fff; }

  .hidden { 
    display: none !important; 
  }

  @media (max-width: 520px) {
    #email-modal .modal-content {
      position: fixed; inset: 0;
      transform: none;
      width: 100vw; height: 100dvh;
      border-radius: 0;
    }
  }

  /* --- HERO DI ONBOARDING --- */
  .landing-hero {
    width: 100%;
    padding: 0;
    margin: 0;
  }
  .landing-hero.hero-hidden {
    display: none !important;
  }
  .hero-shell {
    position: relative;
    overflow: hidden;
    border-radius: 0;
    background: linear-gradient(135deg, #f6ffe7 0%, #ccff7e 52%, #7ee063 100%);
    min-height: calc(100vh - 5rem);
    padding: clamp(5rem, 10vw, 9rem) clamp(7vw, 12vw, 12rem) clamp(4rem, 7vw, 6rem);
    color: #0f2f1a;
  }
  .hero-shell::before,
  .hero-shell::after {
    content: "";
    position: absolute;
    filter: blur(90px);
    opacity: 0.65;
    z-index: 0;
    pointer-events: none;
  }
  .hero-shell::before {
    width: 460px;
    height: 460px;
    background: radial-gradient(circle, rgba(250, 204, 21, 0.55) 0%, rgba(250, 204, 21, 0) 70%);
    top: -120px;
    right: -80px;
  }
  .hero-shell::after {
    width: 520px;
    height: 520px;
    background: radial-gradient(circle, rgba(74, 222, 128, 0.6) 0%, rgba(74, 222, 128, 0) 74%);
    bottom: -160px;
    left: -120px;
  }
  .hero-shell::selection {
    color: #063114;
    background: #fafffb;
  }
  .hero-shell > * {
    position: relative;
    z-index: 1;
  }
  .hero-grid {
    position: relative;
    z-index: 1;
    display: grid;
    grid-template-columns: minmax(0, 1.1fr) minmax(0, 0.9fr);
    gap: clamp(3rem, 6vw, 6rem);
    align-items: center;
  }
  .hero-copy {
    display: grid;
    gap: 1.5rem;
    max-width: 36rem;
  }
  .hero-pill {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    padding: 0.5rem 1.1rem;
    border-radius: 999px;
    font-size: 0.78rem;
    font-weight: 600;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: #1f5f04;
    background: rgba(255, 255, 255, 0.9);
    box-shadow: 0 12px 30px rgba(31, 75, 20, 0.18);
  }
  .hero-heading {
    font-size: clamp(2.4rem, 4.8vw, 3.4rem);
    line-height: 1.05;
    font-weight: 800;
    letter-spacing: -0.035em;
    color: #134023;
  }
  .hero-subheading {
    font-size: 1.1rem;
    line-height: 1.85;
    color: rgba(25, 81, 44, 0.88);
  }
  .hero-cta {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-top: 2rem;
  }
  .hero-cta a,
  .hero-cta button {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    border-radius: 9999px;
    font-weight: 600;
    transition: transform 0.18s ease, box-shadow 0.18s ease;
  }
  .cta-primary {
    padding: 0.85rem 1.8rem;
    background: linear-gradient(135deg, #58cc02, #4ba60d);
    color: #05290c;
    border: none;
    box-shadow: 0 18px 35px rgba(72, 187, 120, 0.35);
  }
  .cta-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 22px 40px rgba(72, 187, 120, 0.45);
  }
  .cta-secondary {
    padding: 0.85rem 1.6rem;
    background: #ffffff;
    color: #1d6b2f;
    border: 1px solid rgba(134, 239, 172, 0.8);
    cursor: pointer;
  }
  .cta-secondary:hover {
    transform: translateY(-1px);
    background: rgba(224, 255, 211, 0.6);
  }
  .cta-disabled {
    pointer-events: none;
    opacity: 0.65;
  }
  .hero-proof {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem 1.25rem;
    align-items: center;
    margin-top: 2.6rem;
    color: rgba(31, 75, 45, 0.9);
  }
  .hero-proof p {
    margin: 0;
    font-size: 0.95rem;
  }
  .avatars {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
  }
  .avatar {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 34px;
    height: 34px;
    border-radius: 999px;
    background: rgba(255, 255, 255, 0.8);
    color: #165824;
    font-size: 0.7rem;
    font-weight: 600;
    letter-spacing: 0.05em;
    border: 1px solid rgba(134, 239, 172, 0.7);
  }
  .avatar.more {
    background: rgba(251, 191, 36, 0.5);
  }
  .hero-reasons {
    display: grid;
    gap: 1.25rem;
  }
  .reason-card {
    display: flex;
    gap: 0.9rem;
    padding: 1rem 1.2rem;
    background: rgba(255, 255, 255, 0.92);
    border-radius: 18px;
    backdrop-filter: blur(8px);
    border: 1px solid rgba(187, 247, 208, 0.9);
    box-shadow: 0 18px 40px rgba(29, 94, 43, 0.18);
  }
  .reason-card .material-symbols-outlined {
    width: 42px;
    height: 42px;
    border-radius: 14px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 22px;
    color: #14532d;
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
    box-shadow: 0 10px 18px rgba(250, 204, 21, 0.35);
  }
  .reason-card h3 {
    font-size: 1.05rem;
    font-weight: 600;
    margin: 0 0 0.25rem;
    color: #14532d;
  }
  .reason-card p {
    margin: 0;
    font-size: 0.95rem;
    color: rgba(43, 89, 54, 0.85);
  }
  .hero-metrics {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
    gap: 1.25rem;
    margin: 2.4rem 0;
  }
  .metric {
    padding: 1.3rem 1.5rem;
    border-radius: 20px;
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(187, 247, 208, 0.9);
    box-shadow: inset 0 0 0 1px rgba(74, 222, 128, 0.18);
  }
  .metric-value {
    display: block;
    font-size: 1.55rem;
    font-weight: 700;
    color: #14532d;
  }
  .metric-label {
    display: block;
    margin-top: 0.3rem;
    font-size: 0.85rem;
    color: rgba(45, 94, 59, 0.8);
  }
  .hero-footnote {
    font-size: 0.8rem;
    color: rgba(45, 94, 59, 0.7);
    display: flex;
    align-items: center;
    gap: 0.4rem;
    max-width: 28rem;
  }

  .hero-visual {
    position: relative;
    display: grid;
    gap: 1.5rem;
    align-items: start;
    justify-items: end;
  }
  .phone-mock {
    position: relative;
    width: 320px;
    max-width: 100%;
    aspect-ratio: 9/19;
    border-radius: 32px;
    padding: 20px 14px;
    background: linear-gradient(160deg, #1e9d42 0%, #0b7d32 80%);
    box-shadow: 0 40px 80px rgba(12, 83, 32, 0.45);
    border: 1px solid rgba(187, 247, 208, 0.25);
    overflow: hidden;
  }
  .phone-notch {
    position: absolute;
    top: 18px;
    left: 50%;
    transform: translateX(-50%);
    width: 42%;
    height: 18px;
    background: rgba(255, 255, 255, 0.5);
    border-radius: 999px;
  }
  .phone-screen {
    position: relative;
    display: grid;
    gap: 1rem;
    height: 100%;
  }
  .screen-header {
    display: flex;
    gap: 0.5rem;
    align-items: center;
    justify-content: center;
  }
  .sh-dot {
    width: 8px;
    height: 8px;
    border-radius: 999px;
    background: rgba(148, 163, 184, 0.4);
  }
  .screen-card {
    border-radius: 18px;
    overflow: hidden;
    background: rgba(243, 255, 235, 0.95);
    border: 1px solid rgba(187, 247, 208, 0.8);
    box-shadow: 0 30px 60px rgba(12, 83, 32, 0.28);
    display: grid;
  }
  .screen-card.alt {
    background: rgba(232, 252, 245, 0.85);
    border-style: dashed;
  }
  .screen-img {
    height: 140px;
    background: linear-gradient(135deg, rgba(250, 204, 21, 0.45), rgba(126, 217, 87, 0.6));
    position: relative;
    overflow: hidden;
  }
  .shimmer::after {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(120deg, transparent 0%, rgba(255, 255, 255, 0.6) 50%, transparent 100%);
    transform: translateX(-100%);
    animation: shimmer-slide 2.2s infinite;
  }
  @keyframes shimmer-slide {
    0% { transform: translateX(-100%); }
    60% { transform: translateX(120%); }
    100% { transform: translateX(120%); }
  }
  .screen-content {
    padding: 1.3rem 1.4rem 1.4rem;
    display: grid;
    gap: 0.6rem;
  }
  .screen-label {
    font-size: 0.75rem;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    color: rgba(100, 116, 78, 0.8);
  }
  .screen-content h2 {
    font-size: 1.1rem;
    line-height: 1.3;
    margin: 0;
    color: #135128;
  }
  .screen-content p {
    margin: 0;
    color: rgba(44, 79, 55, 0.85);
    font-size: 0.95rem;
  }
  .screen-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 0.45rem;
  }
  .chip {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.35rem 0.7rem;
    border-radius: 999px;
    font-size: 0.72rem;
    letter-spacing: 0.05em;
    text-transform: uppercase;
  }
  .chip-green { background: rgba(74, 222, 128, 0.18); color: #16a34a; }
  .chip-purple { background: rgba(250, 204, 21, 0.18); color: #ca8a04; }
  .chip-pink { background: rgba(253, 164, 175, 0.2); color: #f97386; }
  .screen-footer {
    display: grid;
    gap: 0.65rem;
  }
  .footer-pill {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    padding: 0.5rem 0.75rem;
    border-radius: 12px;
    font-size: 0.78rem;
    background: rgba(220, 252, 231, 0.9);
    color: rgba(34, 85, 49, 0.85);
  }
  .hero-bubbles {
    display: grid;
    gap: 1rem;
    max-width: 320px;
    position: relative;
  }
  .bubble {
    display: flex;
    gap: 0.85rem;
    padding: 0.85rem 1rem;
    border-radius: 18px;
    background: rgba(255, 255, 255, 0.92);
    border: 1px solid rgba(187, 247, 208, 0.85);
    box-shadow: 0 18px 40px rgba(29, 94, 43, 0.18);
  }
  .bubble strong {
    display: block;
    font-size: 0.95rem;
    color: #14532d;
  }
  .bubble p {
    margin: 0.15rem 0 0;
    font-size: 0.8rem;
    color: rgba(45, 94, 59, 0.75);
  }
  .bubble-avatar,
  .bubble .material-symbols-outlined {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 38px;
    height: 38px;
    border-radius: 12px;
    background: rgba(34, 197, 94, 0.18);
    color: #166534;
    font-weight: 600;
    font-size: 0.8rem;
  }

  @media (max-width: 768px) {
    .hero-shell {
      min-height: calc(100vh - 4.5rem);
      padding: 6rem 1.75rem 3rem;
    }
    .hero-grid {
      grid-template-columns: 1fr;
      gap: 3rem;
    }
    .hero-cta {
      flex-direction: column;
      align-items: stretch;
    }
    .hero-cta a,
    .hero-cta button {
      justify-content: center;
      width: 100%;
    }
    .hero-reasons { gap: 1rem; }
    .hero-proof { flex-direction: column; align-items: flex-start; }
    .hero-footnote { flex-wrap: wrap; }
    .hero-visual { justify-items: center; }
    .hero-bubbles { max-width: 100%; }
  }

  /* --- STATI DI CARICAMENTO E FEEDBACK (Spinner, Toast, Skeleton) --- */
  .splash-screen {
  position: fixed;
  inset: 0;
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  background: radial-gradient(circle at 20% 20%, rgba(59, 130, 246, 0.18), transparent 55%),
              radial-gradient(circle at 80% 10%, rgba(244, 63, 94, 0.15), transparent 45%),
              linear-gradient(135deg, #0f172a, #111827 55%, #020617);
  color: #f8fafc;
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
  transition: opacity 0.35s ease, visibility 0.35s ease;
}
.splash-screen.splash-visible {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
}
.splash-screen.splash-hidden {
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
}
.splash-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  gap: 1.25rem;
  padding: 2.75rem 3rem;
  background: rgba(15, 23, 42, 0.72);
  border-radius: 24px;
  box-shadow: 0 24px 60px rgba(15, 23, 42, 0.55);
  backdrop-filter: blur(14px);
  border: 1px solid rgba(148, 163, 184, 0.22);
}
.splash-logo {
  display: flex;
  align-items: center;
  gap: 0.8rem;
  font-weight: 700;
  letter-spacing: -0.02em;
}
.splash-logo img {
  width: 48px;
  height: 48px;
  border-radius: 14px;
  box-shadow: 0 10px 24px rgba(15, 23, 42, 0.45);
}
.splash-title {
  font-size: 2rem;
  text-transform: lowercase;
}
.splash-tagline {
  font-size: 0.95rem;
  color: rgba(226, 232, 240, 0.85);
  max-width: 240px;
}
.splash-spinner {
  display: inline-flex;
  align-items: center;
  gap: 0.55rem;
}
.splash-spinner span {
  width: 10px;
  height: 10px;
  border-radius: 999px;
  background: rgba(148, 163, 184, 0.9);
  animation: splashPulse 1s infinite ease-in-out;
}
.splash-spinner span:nth-child(2) { animation-delay: 0.15s; }
.splash-spinner span:nth-child(3) { animation-delay: 0.3s; }

@keyframes splashPulse {
  0%, 80%, 100% { transform: scale(0.6); opacity: 0.45; }
  40% { transform: scale(1); opacity: 1; }
}

#load-more-sentinel { margin-bottom: 80px; }
.loading-indicator {
  text-align: center;
  padding: 2.5rem 1rem;
  color: #4b5563;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1rem;
}
.loading-indicator p {
  font-size: 0.9rem;
  font-weight: 500;
  margin: 0;
  color: #374151;
}
.loading-indicator .loader-visual {
  display: inline-flex;
  align-items: center;
  gap: 0.45rem;
}
  .feed-loader,
  #feed-loading-indicator {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    padding: 3.5rem 1rem;
    text-align: center;
    color: #4b5563;
  }
.feed-loader .loader-visual,
#feed-loading-indicator .loader-visual {
  display: inline-flex;
  align-items: center;
  gap: 0.45rem;
}
.loader-dot {
  width: 11px;
  height: 11px;
  border-radius: 999px;
  background: linear-gradient(135deg, #6366f1, #a855f7);
  box-shadow: 0 0 14px rgba(99, 102, 241, 0.45);
  animation: loaderBlink 1.1s infinite ease-in-out;
}
.loader-dot:nth-child(2) { animation-delay: 0.15s; }
.loader-dot:nth-child(3) { animation-delay: 0.3s; }
  .feed-loader .loader-text {
    font-size: 0.95rem;
    font-weight: 500;
    color: #374151;
  }
  #feed-loading-indicator .loader-text {
    font-size: 0.9rem;
    font-weight: 500;
    color: #4b5563;
  }
  .feed-loader .loader-sub,
  #feed-loading-indicator .loader-sub {
    font-size: 0.85rem;
    color: #6b7280;
    max-width: 280px;
  }

@keyframes loaderBlink {
  0%, 80%, 100% { transform: scale(0.65); opacity: 0.55; }
  40% { transform: scale(1); opacity: 1; }
}

  #img-switch-progress {
    position: fixed; left: 0; top: 0; height: 3px; width: 100%;
    background: linear-gradient(90deg, rgba(0, 0, 0, .15) 0%, rgba(0, 0, 0, .45) 50%, rgba(0, 0, 0, .15) 100%);
    background-size: 200% 100%;
    animation: imgSwitchingIndeterminate 1.2s linear infinite;
    z-index: 9999; display: none;
  }
  body.img-switching #img-switch-progress { display: block; }
  @keyframes imgSwitchingIndeterminate {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
  }

  .image-wrapper:has(img.updating-image)::before {
    content: ""; position: absolute; inset: 0; background: rgba(255, 255, 255, .55); backdrop-filter: blur(2px);
  }
  .image-wrapper:has(img.updating-image)::after {
    content: ""; position: absolute; width: 28px; height: 28px; border: 3px solid rgba(0, 0, 0, .35);
    border-top-color: transparent; border-radius: 50%; top: 50%; left: 50%;
    transform: translate(-50%, -50%); animation: spinImg 0.9s linear infinite;
  }
  @keyframes spinImg { to { transform: translate(-50%, -50%) rotate(360deg); } }

  [data-busy="1"] { position: relative; opacity: .85; pointer-events: none; }
  [data-busy="1"]::after {
    content: ""; position: absolute; right: 12px; top: 50%; width: 16px; height: 16px;
    border: 2px solid currentColor; border-top-color: transparent; border-radius: 50%;
    transform: translateY(-50%); animation: spinBtn .8s linear infinite;
  }
  @keyframes spinBtn { to { transform: translateY(-50%) rotate(360deg); } }

  #toast {
    position: fixed; bottom: 16px; left: 50%; transform: translateX(-50%);
    background: #111; color: #fff; padding: 10px 14px; border-radius: 10px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, .25); z-index: 10000; display: none; font: 600 13px/1.2 system-ui;
  }
  #toast.ok { background: #0f766e; }
  #toast.err { background: #b91c1c; }
  #toast.show { display: block; animation: toastIn .15s ease-out; }
  @keyframes toastIn {
    from { transform: translateX(-50%) translateY(6px); opacity: .001 }
    to { transform: translateX(-50%) translateY(0); opacity: 1 }
  }

  .sr-only {
    position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px;
    overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0;
  }

  #feed-loading-indicator {
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    padding: 4rem 1rem; text-align: center; color: #6b7280;
  }
  #feed-loading-indicator img { width: 60px; height: 60px; margin-bottom: 1rem; }
  #feed-loading-indicator p { font-size: 0.9rem; font-weight: 500; }

  .skeleton-card {
    position: relative; overflow: hidden;
    background-color: #e5e7eb;
    border-radius: 1rem;
    margin-bottom: 1.5rem;
  }
  .skeleton-card .skel-img { width: 100%; padding-top: 56.25%; background-color: #d1d5db; }
  .skeleton-card .p-4 { padding: 1rem; }
  .skeleton-card .skel-line { height: 1rem; margin-bottom: 0.75rem; border-radius: 0.25rem; background-color: #d1d5db; }
  .skeleton-card .skel-line:last-child { margin-bottom: 0; }
  .skeleton-card::after {
    content: ""; position: absolute; inset: 0;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
    transform: translateX(-100%);
    animation: shimmer 1.5s infinite;
  }
  @keyframes shimmer { 100% { transform: translateX(100%); } }

@media (prefers-reduced-motion: reduce) {
  .image-wrapper:has(img.updating-image)::after,
  [data-busy="1"]::after,
  #img-switch-progress,
  .skeleton-card::after,
  .loader-dot,
  .splash-spinner span {
    animation: none !important;
  }
}

  /* --- COMPONENTI SPECIFICI --- */
  footer nav button.nav-active {
    color: var(--accent-static) !important;
  }
  #gphotos-menu-btn { display: flex; align-items: center; justify-content: center; }
  #gphotos-logo-img {
    width: 24px; height: 24px; display: block; margin: 0 auto;
    object-fit: contain; object-position: center;
    transform: translateX(7px);
  }
  /* Assicura che la classe 'hidden' di Tailwind vinca sempre */
  #gphotos-menu-btn.hidden { display: none !important; }

/* Icon buttons (filter, favorite) */
.icon-btn { position: relative; overflow: hidden; background-color: transparent; }
.icon-btn:hover { background-color: rgba(0,0,0,0.06); }
.icon-btn[aria-pressed="true"] { background-color: transparent !important; }
.icon-btn .ripple-circle { position:absolute; border-radius:50%; transform:scale(0); opacity:.35; background:#000; animation:ripple .45s ease-out forwards; pointer-events:none; }
@keyframes ripple { to { transform: scale(4); opacity: 0; } }
.feed-card {
  content-visibility: auto;
  /* Stima un'altezza media per una card completa */
  contain-intrinsic-size: 320px 640px;
}

.skeleton-card {
  content-visibility: auto;
  /* Stima un'altezza per lo skeleton */
  contain-intrinsic-size: 320px 200px;
}
/* giÃ  nascondiamo il blocco sinistro, ma teniamolo */

.icon-btn[aria-pressed="true"] { background-color: transparent !important; }

/* Icone header: visibili sempre (colore scuro di default) */
.icon-btn .material-symbols-outlined { color: #111827; /* gray-900 */ }

/* Cuore attivo (filled) ben visibile */
.icon-btn[aria-pressed="true"] .material-symbols-outlined,
.material-symbols-outlined.ms-filled {
  font-variation-settings: 'FILL' 1, 'wght' 600, 'GRAD' 0, 'opsz' 24 !important;
  color: #dc2626 !important; /* rosso visibile */
}

/* helpers per header compatto */
.hdr-hide {
  display: none !important;
}
.hdr-title {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 60vw;
}
#app-header {
  position: sticky;
  top: 0;
  z-index: 80;
  transition: padding .2s ease-out;
}
#app-header .hdr-bg {
  position: absolute;
  inset: 0;
  background: rgba(255, 255, 255, .8);
  -webkit-backdrop-filter: saturate(180%) blur(8px);
  backdrop-filter: saturate(180%) blur(8px);
  border-bottom: 1px solid rgba(0, 0, 0, .07);
  pointer-events: none;
  transition: background-color .2s ease-out;
}
#header-bar {
  position: relative;
  transition: height .2s ease-out, padding .2s ease-out;
}
#header-left, .brand-logo, .brand-title {
  transition: all .2s ease-out;
}

/* --- STATO COMPATTO --- */

/* 2. Riduci l'altezza del contenitore */
#app-header.compact {
  padding-top: 0;
  padding-bottom: 0;
}
#app-header.compact #header-bar {
  height: 52px; /* <<< Altezza ulteriormente ridotta */
  padding-top: 0.25rem;
  padding-bottom: 0.25rem;
  /* Cambia il layout da 3 a 2 colonne per spostare il titolo */
  grid-template-columns: 1fr auto;
}

/* 3. Nascondi completamente la sezione sinistra (fotocamera) */
#app-header.compact #choose-photo-btn,
#app-header.compact #gphotos-menu-btn {
  display: none;
}

/* 4. Sposta il blocco logo+titolo all'inizio della sua cella (a sinistra) */
#app-header.compact .justify-self-center {
  justify-self: start;
}

/* 5. Rimpicciolisci il titolo. Il logo resta visibile di default. */
#app-header.compact .brand-title {
  font-size: 1.25rem;
}

/* 6. Fallback per browser vecchi */
@supports not (position: sticky) {
  #app-header {
    position: fixed;
    left: 0;
    right: 0;
  }
  main {
    padding-top: 75px;
  }
}
/* Stato lettura */
.read-dot{
  width: 10px; height: 10px; border-radius: 9999px;
  background: #ef4444; /* rosso = non letto */
  border: 1px solid rgba(255,255,255,.6);
  box-shadow: 0 0 0 1px rgba(0,0,0,.15) inset;
  flex-shrink: 0;
}
.feed-card.is-read .read-dot{ background:#10b981; } 
.read-dot-btn {
  padding: 0;
  border: none;
  background: none;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: 9999px; /* Per l'outline del focus */
}

/* Stili per il tooltip dello stato di lettura */
.read-status-tooltip {
  position: fixed; /* Usiamo fixed per evitare problemi con contenitori overflow:hidden */
  z-index: 1000;
  background-color: #1f2937; /* Grigio scuro */
  color: #f9fafb; /* Testo quasi bianco */
  padding: 6px 10px;
  border-radius: 6px;
  font-size: 13px;
  font-weight: 500;
  pointer-events: none; /* Non deve essere cliccabile */
  opacity: 0;
  transform: translateY(4px);
  transition: opacity 0.15s ease-out, transform 0.15s ease-out;
}

.read-status-tooltip.show {
  opacity: 1;
  transform: translateY(0);
}
#ptr {
  /* Aggiunte per un effetto "sticky" piÃ¹ pulito */
  position: sticky;
  top: 0;
  z-index: 70; /* Sotto l'header (z-index: 80) */
  background: var(--app-bg, #F5F5F5);

  /* Stato di base: nascosto e non occupa spazio */
  height: 0;
  opacity: 0;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: .5rem;
  color: #4b5563; /* Grigio scuro per il testo */
  transition: height 0.2s ease-out, opacity 0.2s ease-out;
}

/* Stato di caricamento: occupa spazio e spinge il contenuto verso il basso */
#ptr.ptr--loading {
  height: 64px;
  opacity: 1;
}

/* Stato durante il "pull": l'altezza Ã¨ controllata da JS per la gesture */
#ptr.ptr--pull {
  height: var(--ptr-pull, 0px);
  opacity: 1;
}

#ptr.ptr--ready .ptr-text::after {
  content: " â rilascia per aggiornare";
  font-weight: 600;
}

#ptr .ptr-icon {
  width: 16px;
  height: 16px;
  border: 2px solid currentColor;
  border-top-color: transparent;
  border-radius: 50%;
  /* L'icona appare solo quando si tira abbastanza o si sta caricando */
  opacity: 0;
  transition: opacity .2s ease;
}

#ptr.ptr--pull .ptr-icon,
#ptr.ptr--loading .ptr-icon {
  opacity: 1;
}

#ptr.ptr--loading .ptr-icon {
  animation: spin .8s linear infinite;
}

@keyframes spin { to { transform: rotate(1turn); } }

.prefers-reduced-motion * {
  animation: none !important;
  transition: none !important;
}
